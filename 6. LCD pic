#include <p18f4550.h>

// Configuration Bits
#pragma config FOSC = HS 
#pragma config WDT = OFF 
#pragma config LVP = OFF 
#pragma config PBADEN = OFF

#define RS PORTCbits.RC0
#define RW PORTCbits.RC1
#define EN PORTCbits.RC2

void LCD_data(unsigned char data);
void LCD_cmd(unsigned char cmd);
void LCD_init();
void delay(unsigned int time);

void main() 
{
    TRISD = 0x00;  // LCD data pins as output
    TRISC = 0x00;  // LCD control pins (RC0, RC1, RC2) as output

    LCD_init();

    LCD_cmd(0x80); // Cursor at start
    
    LCD_data('L');
    delay(25);
    LCD_data('C');
    delay(25);
    LCD_data('D');
    delay(25);
    LCD_data('P');
    delay(25);
    LCD_data('I');
    delay(25);
    LCD_data('C');
    delay(25);
    LCD_data('1');
    delay(25);
    LCD_data('8');

    while (1);  // Stay here forever
}

void LCD_data(unsigned char data) 
{
    PORTD = data; 
    RS = 1; 
    RW = 0; 
    EN = 1; 
    delay(2);
    EN = 0;
    delay(2);
}

void LCD_cmd(unsigned char cmd) 
{
    PORTD = cmd;
    RS = 0;
    RW = 0;
    EN = 1;
    delay(2);
    EN = 0;
    delay(2);  // Extra stability
}

void LCD_init() 
{
    delay(15);    
    LCD_cmd(0x38);
    delay(5);
    LCD_cmd(0x01);
    delay(5);
    LCD_cmd(0x06);
    delay(2);
    LCD_cmd(0x0C);
    delay(2);
}

void delay(unsigned int time) 
{
    int i, j;
    for (i = 0; i < time; i++)
        for (j = 0; j < 275; j++);
}
